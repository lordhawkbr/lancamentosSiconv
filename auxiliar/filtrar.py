import pandas as pd

# Arquivos
input_file = "ARQUIVO_TOTAL.csv"
output_file = "ARQUIVO_PARCIAL.csv"

# Lista de matrículas a remover
matriculas = [
    "300336","300335","300334","300333","300332","300331","300330","300329","300328","300327","300326","300325","300324","300323","300321","300320","300319","300318","300317","300316","300315","300314","300313","300311","300310","300308","300307","300306","300305","300304","300303","300302","300301","300300","300299","300298","300297","300296","300295","300294","300293","300292","300291","300290","300289","300288","300287","300286","300285","300284","300283","300282","300281","300280","300279","300278","300277","300276","300275","300274","300273","300272","300270","300269","300268","300267","300266","300265","300264","300263","300262","300261","300260","300259","300257","300256","300255","300254","300253","300252","300251","300250","300249","300248","300247","300246","300245","300244","300243","300242","300241","300240","300239","300238","300237","300236","300235","300234","300233","300231","300230","300229","300227","300224","300223","300222","300220","300219","300218","300217","300215","300214","300213","300212","300211","300209","300208","300207","300206","300205","300204","300203","300202","300201","300199","300198","300197","300196","300195","300194","300193","300192","300191","300189","300188","300187","300186","300185","300184","300182","300181","300180","300179","300178","300177","300176","300175","300174","300172","300171","300170","300169","300168","300166","300165","300164","300163","300162","300161","300160","300159","300158","300157","300156","300155","300153","300151","300150","300149","300148","300146","300145","300144","300143","300141","300140","300139","300136","300134","300133","300132","300131","300130","300128","300127","300126","300125","300124","300123","300122","300121","300120","300118","300117","300116","300115","300114","300113","300112","300111","300110","300109","300108","300107","300106","300104","300103","300102","300101","300100","300099","300098","300097","300096","300095","300094","300093","300092","300091","300090","300089","300088","300087","300086","300084","300083","300082","300081","300080","300079","300077","300076","300075","300074","300073","300072","300071","300070","300069","300068","300067","300066","300064","300063","300062","300061","300060","300059","300058","300057","300056","300055","300054","300053","300052","300051","300050","300049","300048","300047","300046","300045","300044","300043","300042","300040","300039","300038","300037","300036","300035","300034","300033","300032","300030","300029","300028","300027","300026","300025","300024","300023","300022","300020","300018","300017","300016","300015","300014","300013","300012","300011","300009","300008","300007","300006","300004","300003","300002","300001","300210","300167","300190","300137"
]

# Ler CSV ignorando linhas com erro de colunas
df = pd.read_csv(input_file, sep=";", encoding="utf-8", dtype={"Matricula": str}, engine="python", on_bad_lines="skip")

# Filtrar removendo matrículas indesejadas
df_filtrado = df[~df["Matricula"].isin(matriculas)]
#Filtrar e manter as matriculas desejadas
# df_filtrado = df[df["Matricula"].isin(matriculas)]

# Salvar novo arquivo
df_filtrado.to_csv(output_file, sep=";", index=False, encoding="utf-8")

print(f"Arquivo filtrado salvo como: {output_file}")
